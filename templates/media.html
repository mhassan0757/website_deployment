<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ media.title }} | MediaStream</title>
    <style>
        :root {
            --bg: #f0f2f5;
            --card: #ffffff;
            --text-main: #1c1e21;
            --text-muted: #65676b;
            --accent: #1877f2;
            --border: #dddfe2;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Container */
        .media-container {
            max-width: 800px;
            width: 100%;
            background: var(--card);
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-bottom: 20px;
        }

        /* Media Header */
        .media-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
        }

        .media-header h1 { margin: 0 0 10px 0; font-size: 1.5rem; }
        .meta-info { font-size: 0.9rem; color: var(--text-muted); line-height: 1.6; }
        .meta-info span { color: var(--accent); font-weight: 600; }

        /* Media Display */
        .media-content {
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 300px;
        }

        .media-content img, .media-content video {
            max-width: 100%;
            display: block;
            height: auto;
        }

        /* Interaction Section (Rate & Comment) */
        .interaction-panel {
            padding: 20px;
        }

        .rating-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
        }

        select, textarea {
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 8px;
            font-size: 1rem;
        }

        button {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        button:hover { opacity: 0.8; }

        /* Comments Section */
        .comments-section h3 { border-bottom: 1px solid var(--border); padding-bottom: 10px; }
        
        .comment {
            padding: 12px 0;
            border-bottom: 1px solid #f0f2f5;
        }

        .comment strong { font-size: 0.95rem; color: var(--accent); }
        .comment small { color: var(--text-muted); float: right; }
        .comment-text { margin-top: 5px; font-size: 0.95rem; }

        .comment-form textarea {
            width: 100%;
            box-sizing: border-box;
            resize: vertical;
            margin-bottom: 10px;
        }

        .back-link {
            text-decoration: none;
            color: var(--text-muted);
            font-weight: 500;
            margin-bottom: 20px;
        }

        .back-link:hover { color: var(--accent); }
    </style>
</head>
<body>

    <header style="width:100%;max-width:900px;margin-bottom:1rem;display:flex;justify-content:space-between;align-items:center;">
        <div style="font-weight:700">MEDIASTREAM</div>
        <div>
            {% if session.user_name %}
                Welcome, {{ session.user_name }} ‚Ä¢ <a href="/logout">Logout</a>
            {% else %}
                <a href="/login">Login</a>
            {% endif %}
        </div>
    </header>

    <a href="/creator" class="back-link">‚Üê Back to Feed</a>

    <article class="media-container">
        <div class="media-header">
            <h1>{{ media.title }}</h1>
            <div class="meta-info">
                Uploaded by <span>{{ media.uploader_name }}</span><br>
                üìç {{ media.location }} | üë• {{ media.people|join(', ') }}
                <p style="margin-top: 10px; color: var(--text-main);">{{ media.caption }}</p>
            </div>
        </div>

        <div class="media-content">
            {% if media.filename.endswith('.mp4') or media.filename.endswith('.webm') %}
                <video controls>
                    <source src="/uploads/{{ media.filename }}" type="video/mp4">
                    Your browser does not support video.
                </video>
            {% else %}
                <img src="/uploads/{{ media.filename }}" alt="{{ media.title }}">
            {% endif %}
        </div>

        <div class="interaction-panel">
            <div class="rating-section">
                <span>Rate this content:</span>
                <form action="/api/media/{{ media._id }}/rate" method="post" style="display: flex; gap: 10px;">
                    <select name="score">
                        <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5)</option>
                        <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê (4)</option>
                        <option value="3">‚≠ê‚≠ê‚≠ê (3)</option>
                        <option value="2">‚≠ê‚≠ê (2)</option>
                        <option value="1">‚≠ê (1)</option>
                    </select>
                    <button type="submit">Rate</button>
                </form>
            </div>

            <div class="comments-section">
                <h3>Comments</h3>
                
                <form class="comment-form" action="/api/media/{{ media._id }}/comment" method="post">
                    <textarea name="text" rows="3" placeholder="Write a comment..." required></textarea>
                    <button type="submit">Post Comment</button>
                </form>

                <div style="margin-top: 20px;">
                    {% for c in comments %}
                        <div class="comment">
                            <strong>{{ c.user_name }}</strong>
                            <small>{{ c.created_at }}</small>
                            <div class="comment-text">{{ c.text }}</div>
                        </div>
                    {% else %}
                        <p style="color: var(--text-muted); text-align: center;">No comments yet. Be the first!</p>
                    {% endfor %}
                </div>
            </div>
        </div>
    </article>

</body>
</html>